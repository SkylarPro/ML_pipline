# MILTestTasks
В данном репоззитории находится описание тестовых заданий.  
Каждое задание представлено в отдельной ветке.


# Тестовое задание
Написать и обучить модель-автокодировщик на датасете на выбор: MNIST, CIFAR10, CIFAR100.
Обучить модель-классификатор на латентных представлениях обученного автокодировщика.


### Рекомендуемые шаги для выполнения задания

**Шаг 1.** Подготовка инфраструктуры.

"Создание окружения, организация структуры репозитория, загрузка датасетов."
1. **Каталог inference** - в нем реализован inference модели с подсчетом метрик на тестовых данных. Для запуска Вам необходимо в cfg_model указать путь до чекпойнта Вашей модели и название модели (тестовый пример уже реализован)
Запуск: python3  inference/inference.py Результаты сохраняются в inference/logs/NAME_MODEL
2. **Каталог data** - в нем лежит dataset CIFAR100
3. **Каталог src** - в нем реализован весь функционал pipeline 
3.1 **Каталог src/pipeline** - в нем находится этапы тренировки, валидации и вузальной валидации логируется для каждого отдельного запуска в папку pipeline/logs
3.2 **Каталог src/utils** - в нем находятся реализации функционала для pipeline
3.3 **Каталог src/models** - в нем находятся реализации моделей AE

**Шаг 2.** Реализовать модель-автоенкодер.
"Выбрать архитектуру и реализовать ее совместно с процедурой обучения, подходящей для выбранного датасета."
Реализованы две модели AE:
1. "AutoEncoder" - В данной модели отсутствуют скипы для того чтобы img2img decoder опирался только на информацию из латентного пр-ва и тренировалась ее репрезинтативность, латентное пр-во сжимается до (N,256,2,2)
2. "ResNetUnet" - В данной модели реализованы скипы, латентное пр-во сжимается до (N,256,2,2)


Для обучения моделей необходимо указать в конфиге cfg_model["name"] = NAME_Model в src/pipeline/pipline.py  выполнить python3 src/pipeline/pipline.py (также можете указать путь к весам на данную модель)

"Важно обратить внимание на выбор размерность скрытого состояния. Обосновать свой выбор."

Размер скрытого слоя (N,256,2, 2) не хотел убивать рецептив филд в (1,1) в пользу увеличения запонимания различных паттернов, так как будет нетривиальна информация о пространсвенной связи пикселей а голова на классификацию норм скушает вектор размерности 1024

**Шаг 3.** Обучить автоенкодер.
Нужно обучить реализованную архитектуру на скаченном датасете.
python3 src/pipeline/pipline.py - обучение архитектуры c mode = "img_to_img" можно настроить в config_train и выбрать лоссы для обучения по дефолту SSIM, L1
Оценить качество работы модели.
!tensorboard --logdir src/pipeline/logs/NAME_LAUNCH --port=8800

**Шаг 4.** Реализовать модель-классификатор.
"Реализовать небольшую модель классификатор на скрытых представлениях уже обученного автоенкодера."

Модель реализована как голова с последнего слоя encoder в моделях AutoEncoder, ResNetUnet
"Реализовать пайплайн обучения данной модели."
Измените в src/pipeline/pipline.py mode = "img_to_cls" и запустите python3 src/pipeline/pipline.py - обучение архитектуры c  можно настроить в config_train
"Оценить качество работы модели."
!tensorboard --logdir src/pipeline/logs/NAME_LAUNCH --port=8800


**Шаг 5.** Обучение модели классификатора и визуализация результатов.

"На этом шаге требуется обучить модель классификатор и оценить ее качество."
Обучение описано в пункте 4
"Подумайте, в каком виде было бы удобно провести демонстрацию результатов?"
Для инфмеренса модели необходимо запустить python3 src/pipeline/pipline.py перед этим указать модель и ее веса в cfg_model
Результат будет как принт на экран значение Accuracy и confusion_matrix в папке inference/logs/NAME_Model/confmatrix.png

**Шаг 6.** Выводы и идеи.

"Проведите анализ результатов, сделайте несколько выводов на основе полученных рузультатов.
Предложите свои идеи, как можно улучшить текущие результаты."

В прикрепленном pdf файле


### Что будет оцениваться?
1. Реализация и оформление кода на github.
2. Соответствие решения тестовому заданию.
3. Оформление результатов.
4. Любые релевантные мысли, идеи и соображения.
5. Будет плюсом проведение нескольких экспериментов и их анализ.
---

Резюме можно отправлять на почту info@machine-intelligence.ru или через форму на [сайте](https://machine-intelligence.ru/join-us/cv).

